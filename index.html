<head>
  <title>Code benefactor</title>
  <link rel="icon" type="image/png" href="favicon.png" sizes="32x32">
  <link rel="stylesheet" href="http://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.12.0/build/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="http://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.12.0/build/highlight.min.js"></script>
  <script>
  const config = {
    language: 'javascript',
    lineBreak: true,
    keyword: "ยง!"
  }
  </script>
</head>

<body>
  <input type="file" id="file">
  <pre><code class="code">
  </code></pre>
  <div class="result"></div>
  <script>
  let speed = 50
  let i = 0
  let lineNb = 1
  let writing = false;
  let actualText = ''
  let codeContainer = document.querySelector(".code")
  /*console.log = function(text) {
    container = document.querySelector('.result')
    container.innerHTML += `<p>${text}</p>`
    container.scrollTop = container.scrollHeight;
  }
  console.error = function(text) {
    container = document.querySelector('.result')
    container.innerHTML += `<p class='error'>${text}</p>`
    container.scrollTop = container.scrollHeight;
  }*/
  function fileSelected() {
    codeContainer.classList.add(config.language)
    codeContainer.innerHTML = null;
    var selectedFile = document.getElementById('file').files[0];
    var reader = new FileReader();
    let text = ''
    reader.readAsText(selectedFile);
    reader.onload = function(event) {
      document.getElementById('file').classList.add('hidden')
      let text = reader.result;
      text = getLine(text)
      hljs.highlightBlock(codeContainer);
    };
}

function getLine(text) {
  let i = 0;
  line = '';
  if(text[i] !== '\n') {
  while(text[i] != '\n' && text[i] != undefined) {
    line+=text[i]
    i++
  }
  text = text.substr(line.length)
  codeContainer.innerHTML += `<p>/*${lineNb}*/ ${line}</p>`
} else {
  text = text.substr(1)
  codeContainer.innerHTML += `<p>/*${lineNb}*/</p>`
}
lineNb++
  if(text.length > 1)
    getLine(text)
}

document.querySelector("#file").addEventListener('change',fileSelected)
  </script>
</body>
